$(window).load(function(){$(".se-pre-con").fadeOut("slow")});var userDetails=[],timelineImageList=[],maxLikes=[],averageLike=0,username="",totalTimelineImages=0,progressPer=0,imageFetchLimit=50,likeTrend={label:[],like:[],avg:0},likeTrend_thisMonth={label:[],like:[],avg:0},likeTrend_lastMonth={label:[],like:[],avg:0},likeTrend_last6Month={label:[],like:[],avg:0},today=new Date,curr_month_firstDay=new Date(today.getFullYear(),today.getMonth(),1),curr_month_lastDay=new Date(today.getFullYear(),today.getMonth()+1,0),last_month_firstDay=new Date(today.getFullYear(),today.getMonth()-1,1),sixth_month_firstDay=new Date(today.getFullYear(),today.getMonth()-5,1);function resetProgress(){$(".progress").css("width","0%")}function progress(e){$(".progress").css("width",e+"%")}function getMore(e,t){progressPer+=imageFetchLimit,progress(Math.round(progressPer/totalTimelineImages*100)),$("#image-loader").show(),$.ajax({url:"https://www.instagram.com/graphql/query/",type:"get",data:{query_hash:"003056d32c2554def87228bc3fd9668a",variables:'{ "id": "'+e+'", "first": '+imageFetchLimit+', "after": "'+t+'"}'},success:function(e){if(e.data){const t=e.data;for(item of t.user.edge_owner_to_timeline_media.edges)item.node.edge_media_to_caption||(item.node.edge_media_to_caption={edges:[{node:{text:""}}]}),item.node.external_url||(item.node.external_url="",item.node.external_url_linkshimmed=""),averageLike+=Number(item.node.edge_media_preview_like.count),timelineImageList.push(item.node);if(1==t.user.edge_owner_to_timeline_media.page_info.has_next_page){const e=t.user.edge_owner_to_timeline_media.page_info.end_cursor,i=userDetails.id;setTimeout(function(){getMore(i,e)},2e3)}else progress(100),$("#image-loader").fadeOut(),renderUI()}},error:function(e){console.log(e)}})}function renderUI(){for(item of((maxLikes=[...timelineImageList]).sort(function(e,t){var i=e.edge_media_preview_like.count,a=t.edge_media_preview_like.count;return i>a?-1:i<a?1:0}),[...timelineImageList].reverse())){const e=new Date(1e3*item.taken_at_timestamp),t={label:e.toLocaleDateString("en-IN"),like:item.edge_media_preview_like.count};likeTrend.label.push(t.label),likeTrend.like.push(t.like),likeTrend.avg+=t.like,e>=curr_month_firstDay&&e<=curr_month_lastDay&&(likeTrend_thisMonth.label.push(t.label),likeTrend_thisMonth.like.push(t.like),likeTrend_thisMonth.avg+=t.like),e>=last_month_firstDay&&e<=curr_month_firstDay&&(likeTrend_lastMonth.label.push(t.label),likeTrend_lastMonth.like.push(t.like),likeTrend_lastMonth.avg+=t.like),e>=sixth_month_firstDay&&e<=curr_month_lastDay&&(likeTrend_last6Month.label.push(t.label),likeTrend_last6Month.like.push(t.like),likeTrend_last6Month.avg+=t.like)}likeTrend.avg=Math.round(likeTrend.avg/likeTrend.label.length),likeTrend_thisMonth.avg=Math.round(likeTrend_thisMonth.avg/likeTrend_thisMonth.label.length),likeTrend_lastMonth.avg=Math.round(likeTrend_lastMonth.avg/likeTrend_lastMonth.label.length),likeTrend_last6Month.avg=Math.round(likeTrend_last6Month.avg/likeTrend_last6Month.label.length),document.getElementById("instagram-wrapper").innerHTML="<div class=\"instagram\">\n                <p style='margin-top: 10px; margin-bottom: 20px'>Showing result for: "+username+'</p>\n    <div class="instagram-header">\n        <div class="flex vertical-center instagram-header-details">\n            <img src="'+userDetails.profile_pic_url+'">\n            <div class="flex vertical-center space-between">\n                <div>\n                    <span class="title">'+userDetails.edge_owner_to_timeline_media.count+'</span>\n                    <span>Posts</span>\n                </div>\n                <div>\n                    <span class="title">'+userDetails.edge_followed_by.count+'</span>\n                    <span>Followers</span>\n                </div>\n                <div>\n                    <span class="title">'+userDetails.edge_follow.count+'</span>\n                    <span>Following</span>\n                </div>\n            </div>\n        </div>\n        <div class="instagram-header-bio">\n            <p class="name">'+userDetails.full_name+"</p>\n            <pre>"+userDetails.biography+"</pre>\n            <a target='_blank' href=\""+userDetails.external_url_linkshimmed+'">'+userDetails.external_url+'</a>\n        </div>\n    </div>\n    <div class="instagram-body">\n        <section>\n            <p class="section-title">Lastest 3 images uploaded:</p>\n            <div class="flex instagram-image-container">\n                <div class="image-wrapper">\n                <img title="'+timelineImageList[0].edge_media_to_caption.edges[0].node.text+'" alt="'+timelineImageList[0].edge_media_to_caption.edges[0].node.text+'" src="'+timelineImageList[0].display_url+'">\n                <p>'+timelineImageList[0].edge_media_preview_like.count+'<i class="fa fa-heart"></i></p>\n                </div>\n                <div class="image-wrapper">\n                <img title="'+timelineImageList[1].edge_media_to_caption.edges[0].node.text+'" alt="'+timelineImageList[1].edge_media_to_caption.edges[0].node.text+'" src="'+timelineImageList[1].display_url+'">\n                <p>'+timelineImageList[1].edge_media_preview_like.count+'<i class="fa fa-heart"></i></p>\n                </div>\n                <div class="image-wrapper">\n                <img title="'+timelineImageList[2].edge_media_to_caption.edges[0].node.text+'" alt="'+timelineImageList[2].edge_media_to_caption.edges[0].node.text+'" src="'+timelineImageList[2].display_url+'">\n                <p>'+timelineImageList[2].edge_media_preview_like.count+'<i class="fa fa-heart"></i></p>\n                </div>\n            </div>\n        </section>\n        <section>\n            <p class="section-title">Least liked 3 images:</p>\n            <div class="flex instagram-image-container">\n                <div class="image-wrapper">\n                <img title="'+maxLikes[maxLikes.length-1].edge_media_to_caption.edges[0].node.text+'" alt="'+maxLikes[maxLikes.length-1].edge_media_to_caption.edges[0].node.text+'" src="'+maxLikes[maxLikes.length-1].display_url+'">\n                    <p>'+maxLikes[maxLikes.length-1].edge_media_preview_like.count+'<i class="fa fa-heart"></i></p>\n                </div>\n                <div class="image-wrapper">\n                <img title="'+maxLikes[maxLikes.length-2].edge_media_to_caption.edges[0].node.text+'" alt="'+maxLikes[maxLikes.length-2].edge_media_to_caption.edges[0].node.text+'" src="'+maxLikes[maxLikes.length-2].display_url+'">\n                    <p>'+maxLikes[maxLikes.length-2].edge_media_preview_like.count+'<i class="fa fa-heart"></i></p>\n                </div>\n                <div class="image-wrapper">\n                <img title="'+maxLikes[maxLikes.length-3].edge_media_to_caption.edges[0].node.text+'" alt="'+maxLikes[maxLikes.length-3].edge_media_to_caption.edges[0].node.text+'" src="'+maxLikes[maxLikes.length-3].display_url+'">\n                    <p>'+maxLikes[maxLikes.length-3].edge_media_preview_like.count+'<i class="fa fa-heart"></i></p>\n                </div>\n        </section>\n        <section>\n            <p class="section-title">Most liked 3 images:</p>\n            <div class="flex instagram-image-container">\n                <div class="image-wrapper">\n                <img title="'+maxLikes[0].edge_media_to_caption.edges[0].node.text+'" alt="'+maxLikes[0].edge_media_to_caption.edges[0].node.text+'" src="'+maxLikes[0].display_url+'">\n                    <p>'+maxLikes[0].edge_media_preview_like.count+'<i class="fa fa-heart"></i></p>\n                </div>\n                <div class="image-wrapper">\n                <img title="'+maxLikes[1].edge_media_to_caption.edges[0].node.text+'" alt="'+maxLikes[1].edge_media_to_caption.edges[0].node.text+'" src="'+maxLikes[1].display_url+'">\n                    <p>'+maxLikes[1].edge_media_preview_like.count+'<i class="fa fa-heart"></i></p>\n                </div>\n                <div class="image-wrapper">\n                <img title="'+maxLikes[2].edge_media_to_caption.edges[0].node.text+'" alt="'+maxLikes[2].edge_media_to_caption.edges[0].node.text+'" src="'+maxLikes[2].display_url+'">\n                    <p>'+maxLikes[2].edge_media_preview_like.count+'<i class="fa fa-heart"></i></p>\n                </div>\n        </section>\n        <section>\n            <p class="section-title">Like trend:</p>\n            <p>Blue line in the chart dipicts the average like trend.</p>\n\n            <p>This month:</p>\n            <p>You are getting an average '+likeTrend_thisMonth.avg+' likes on each image.</p>\n            <div class="flex instagram-graph-container">\n                <canvas id="likeTrend_thisMonth" width="400" height="400"></canvas>\n            </div>\n\n            <p>Last month:</p>\n            <p>You are getting an average '+likeTrend_lastMonth.avg+' likes on each image.</p>\n            <div class="flex instagram-graph-container">\n                <canvas id="likeTrend_lastMonth" width="400" height="400"></canvas>\n            </div>\n\n            <p>Last 6 month:</p>\n            <p>You are getting an average '+likeTrend_last6Month.avg+' likes on each image.</p>\n            <div class="flex instagram-graph-container">\n                <canvas id="likeTrend_last6Month" width="400" height="400"></canvas>\n            </div>\n\n            <p>All time:</p>\n            <p>You are getting an average '+likeTrend.avg+' likes on each image.</p>\n            <div class="flex instagram-graph-container">\n                <canvas id="likeTrend" width="400" height="400"></canvas>\n            </div>\n        </section>\n        <section>\n            <p class="section-title">Worst time to upload:</p>\n            <div class="flex">\n                Post uploaded on '+new Date(1e3*maxLikes[maxLikes.length-1].taken_at_timestamp).toLocaleString("en-IN")+" got minimum '"+maxLikes[maxLikes.length-1].edge_media_preview_like.count+'\' likes.\n            </div>\n        </section>\n        <section>\n            <p class="section-title">Best time to upload:</p>\n            <div class="flex">\n                Post uploaded on '+new Date(1e3*maxLikes[0].taken_at_timestamp).toLocaleString("en-IN")+" got maximum '"+maxLikes[0].edge_media_preview_like.count+"' likes.\n            </div>\n        </section>\n    </div>\n</div>\n                ",$(".instagram").show(),new Chart(document.getElementById("likeTrend_thisMonth").getContext("2d"),{type:"line",data:{labels:likeTrend_thisMonth.label,datasets:[{label:"# of Likes",data:likeTrend_thisMonth.like,backgroundColor:["rgba(255, 99, 132, 0.2)"],borderColor:["rgba(255, 99, 132, 1)"],borderWidth:1,trendlineLinear:{style:"#3e95cd",lineStyle:"line",width:1}}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{ticks:{display:!1}}],xAxes:[{ticks:{display:!1}}]}}}),new Chart(document.getElementById("likeTrend_lastMonth").getContext("2d"),{type:"line",data:{labels:likeTrend_lastMonth.label,datasets:[{label:"# of Likes",data:likeTrend_lastMonth.like,backgroundColor:["rgba(255, 99, 132, 0.2)"],borderColor:["rgba(255, 99, 132, 1)"],borderWidth:1,trendlineLinear:{style:"#3e95cd",lineStyle:"line",width:1}}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{ticks:{display:!1}}]}}}),new Chart(document.getElementById("likeTrend_last6Month").getContext("2d"),{type:"line",data:{labels:likeTrend_last6Month.label,datasets:[{label:"# of Likes",data:likeTrend_last6Month.like,backgroundColor:["rgba(255, 99, 132, 0.2)"],borderColor:["rgba(255, 99, 132, 1)"],borderWidth:1,trendlineLinear:{style:"#3e95cd",lineStyle:"line",width:1}}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{ticks:{display:!1}}]}}}),new Chart(document.getElementById("likeTrend").getContext("2d"),{type:"line",data:{labels:likeTrend.label,datasets:[{label:"# of Likes",data:likeTrend.like,backgroundColor:["rgba(255, 99, 132, 0.2)"],borderColor:["rgba(255, 99, 132, 1)"],borderWidth:1,trendlineLinear:{style:"#3e95cd",lineStyle:"line",width:1}}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{ticks:{display:!1}}]}}})}function submit(){if(0==(username=$("#search_key").val().replace(/\s+/g,"").toLowerCase()).length)return $.dialog({title:"Oops!",content:"Please enter username."}),!1;$(".section-loader").fadeIn(),resetProgress(),document.getElementById("instagram-wrapper").innerHTML="";var e="https://www.instagram.com/"+username+"/?__a=1";$.get(e,function(e){if(e){for(userDetails=e.graphql.user,totalTimelineImages=Number(userDetails.edge_owner_to_timeline_media.count);timelineImageList.length>0;)timelineImageList.pop();for(item of userDetails.edge_owner_to_timeline_media.edges)item.node.edge_media_to_caption||(item.node.edge_media_to_caption={edges:[{node:{text:""}}]}),item.node.external_url||(item.node.external_url="",item.node.external_url_linkshimmed=""),averageLike+=Number(item.node.edge_media_preview_like.count),timelineImageList.push(item.node);if(1==userDetails.edge_owner_to_timeline_media.page_info.has_next_page){const e=userDetails.edge_owner_to_timeline_media.page_info.end_cursor;getMore(userDetails.id,e)}$(".section-loader").fadeOut()}else $.dialog({title:"Oops!",content:"No user found!"})}).fail(function(){$.dialog({title:"Oops!",content:"No user found!"})}).always(function(){$(".section-loader").fadeOut()})}$(document).ready(function(){$("#search_key").keypress(e=>{13==e.keyCode&&submit()}),$("#side_search_key").keypress(e=>{13==e.keyCode&&fetch_details()}),$(".tag").click(e=>{selectTag(e.target)}),$("#image-loader").hide(),resetProgress(),$(".section-loader").fadeOut()});